### [始めに戻る](./README.md/) <br>


### SQLインジェクション脆弱性対策について
#### 【原因】
SQLをアプリケーションから利用する場合、SQL文のリテラル部分をパラメータ化することが一般的です。<br>

（リテラル）<br>
変数や定数以外の、数値や文字列など表記どおりの値の総称です。<br>
256、"Rhythm"、2007-10-01といった数値や文字列、日付がリテラルにあたります。<br>

パラメータ化された部分を実際の値に展開するとき、リテラルとして文法的に正しく文を生成しないと、パラメータに与えられた値がリテラルの外にはみ出した状態になり、<br>
リテラルの後ろに続く文として解釈されることになります。<br>

   →　この現象がSQLインジェクションです<br>

〇文字列リテラルに対するＳＱＬインジェクションの例

<img width="1131" height="461" alt="image" src="https://github.com/user-attachments/assets/5fdc7e95-a336-40e2-a3f7-5a5d886c9f8d" />
SELECT 文の後ろに DELETE 文が追加され、データベースの内容がすべて削除される結果になります。<br>

〇　数字リテラルに対するＳＱＬインジェクション例
<img width="1175" height="531" alt="image" src="https://github.com/user-attachments/assets/2b50a310-52af-47ae-9e4d-916931079c2a" />
SELECT 文の後ろに DELETE 文が追加され、データベースの内容がすべて削除される結果になります。<br>

#### 【対策】
プレースホルダによるSQLの組み立てを実施する<br>

（プレースホルダによる組み立てとは？？）<br>
　　　　パラメータ部分を「?」などの記号で示しておき、後に、そこへ実際の値を機械的な処理で割り当てる方法です<br> 


プレースホルダを使って指定しておけば、その部分はあくまで「値」として処理され、万が一不正な値が入力されても、<br>
SQL命令に関わるような「特殊文字」は無効化（エスケープ処理と言います）されるため、SQL文として実行されることはなくなります<br>

参考：IPA安全なSQLの呼び出し方<br>
　　　　　　　　　　　　　https://www.ipa.go.jp/files/000017320.pdf<br>

(対策前におけるDBへのアクセス】<br>
<img width="1192" height="732" alt="image" src="https://github.com/user-attachments/assets/4ff935c4-33e8-47b1-9918-c3f4c44732b1" />

DBアクセスの方法を修正するために以下の考え方で修正します！<br>
（プリペアステートメントとバインドパラメータ）<br>
〇プリペアドステートメント<br>
　SQLのテンプレートのようなもので、複雑なSQLをシンプルに記述するための仕組み<br>

〇PHPにおけるプリペアステートメント関数　→　bindParam()関数<br>
　プリペアドステートメントで使用するSQL文の中で、プレースホルダーに値をバインドするための関数です<br>

bindParam()関数を使用した例<br>
<img width="1197" height="613" alt="image" src="https://github.com/user-attachments/assets/9204726d-8c96-4bda-8b33-c954ca1674ba" />

(対策後におけるDBへのアクセス】<br>
<img width="1207" height="724" alt="image" src="https://github.com/user-attachments/assets/892fdbb6-cffe-4aa9-9ae8-981bc2850004" />

<img width="1196" height="774" alt="image" src="https://github.com/user-attachments/assets/bba182b1-a6ed-44ba-93cf-f3e76e7a3f4f" />
<img width="1198" height="622" alt="image" src="https://github.com/user-attachments/assets/75387a81-242c-42a0-a06a-8878c04b003c" />


【SQLインジェクションに対する脆弱性有無の判断方法】
<img width="1192" height="583" alt="image" src="https://github.com/user-attachments/assets/0d3b9283-b1ed-4489-aa0c-2c75576e929f" />




